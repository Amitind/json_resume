#!/usr/bin/env ruby

require "thor"

class JsonResumeCLI < Thor
  desc "convert /path/to/json/file", "converts the json to pretty resume format"
  option :out, :default=>"html", :banner=>"output_type", :desc=>"html|html_pdf|tex|tex_pdf|md"
  option :template, :banner=>"template_path", :desc=>"path to customized template (optional)"
  def convert(json_input)
    template = options[:template] || "templates/default_#{options[:out]}.mustache"
    puts "Hello #{json_input} #{options} #{template}"
  end

  desc "sample", "Generates a sample json file in cwd"
  def sample()
    cwd = Dir.pwd 
    orig_locn = File.expand_path(File.dirname(__FILE__))
    json_file_paths = Dir["#{orig_locn}/../examples/*.json"]
    json_file_names = json_file_paths.map{|x| File.basename(x)}
    FileUtils.cp json_file_paths, Dir.pwd
    puts "Generated #{json_file_names.join(" ")} in #{cwd}."
    puts "You can now modify it and call: json_resume convert <file.json>"
  end
end

JsonResumeCLI.start(ARGV)
